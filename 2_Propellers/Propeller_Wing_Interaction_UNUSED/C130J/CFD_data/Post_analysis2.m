clear all ; close all ; clc

chord_off =    [    2.8700
    2.8800
    2.8900
    2.9200
    2.9600
    3.0000
    3.0500
    3.1100
    3.1700
    3.2400
    3.3100
    3.3900
    3.4700
    3.5600
    3.6400
    3.6800
    3.7200
    3.8000
    3.8800
    3.9500
    4.0300
    4.1000
    4.1700
    4.2400
    4.2700
    4.3000
    4.3700
    4.4300
    4.4800
    4.5400
    4.5800
    4.6300
    4.6700
    4.7100
    4.7300
    4.7400
    4.7500
    4.7700
    4.8000
    4.8200
    4.8400
    4.8600
    4.8700
    4.8800
    4.8900
    4.8900
    4.9000
    4.9000
    4.9000
    4.9000
    4.9000
    4.9000
    4.9000
    4.8900
    4.8900
    4.8800
    4.8700
    4.8600
    4.8400
    4.8200
    4.8000
    4.7700
    4.7500
    4.7400
    4.7300
    4.7100
    4.6700
    4.6300
    4.5800
    4.5400
    4.4800
    4.4300
    4.3700
    4.3000
    4.2700
    4.2400
    4.1700
    4.1000
    4.0300
    3.9500
    3.8800
    3.8000
    3.7200
    3.6800
    3.6400
    3.5600
    3.4700
    3.3900
    3.3100
    3.2400
    3.1700
    3.1100
    3.0500
    3.0000
    2.9600
    2.9200
    2.8900
    2.8800
    2.8700
         2.87];
chord_on = [    2.8700
    2.8700
    2.8800
    2.9000
    2.9300
    2.9600
    2.9900
    3.0300
    3.0800
    3.1300
    3.1800
    3.2400
    3.3100
    3.3800
    3.4500
    3.8100
    4.1800
    4.2500
    4.3300
    4.4000
    4.4800
    4.5600
    4.6400
    4.7200
    4.7600
    4.8000
    4.8800
    4.9700
    5.0500
    5.1300
    5.2200
    5.3000
    5.3800
    5.4600
    5.6200
    5.7500
    5.7400
    5.7400
    5.7300
    5.7300
    5.7200
    5.7100
    5.7100
    5.2900
    4.8800
    4.8900
    4.8900
    4.9000
    4.9000
    4.9000
    4.9000
    4.9000
    4.8900
    4.8900
    4.8800
    5.2900
    5.7100
    5.7100
    5.7200
    5.7300
    5.7300
    5.7400
    5.7400
    5.7500
    5.6200
    5.4600
    5.3800
    5.3000
    5.2200
    5.1300
    5.0500
    4.9700
    4.8800
    4.8000
    4.7600
    4.7200
    4.6400
    4.5600
    4.4800
    4.4000
    4.3300
    4.2500
    4.1800
    3.8100
    3.4500
    3.3800
    3.3100
    3.2400
    3.1800
    3.1300
    3.0800
    3.0300
    2.9900
    2.9600
    2.9300
    2.9000
    2.8800
    2.8700
    2.8700
         2.87];
correction_factor = chord_on./chord_off;

system('sh ./Programme2.sh')


CFD7 = readtable('Figure14a.csv','NumHeaderLines',2);
CFD5 = readtable('Figure12.csv','NumHeaderLines',2);
ASWING1 =  readtable('A9.txt','NumHeaderLines',33)


inch2meter = 0.0254;
figure(7)
plot(inch2meter*CFD5.Var7,CFD5.Var8,'-ko')
hold on
temp = ASWING1.Var3/3003;
I_end = floor(length(temp)/2)
plot(ASWING1.Var2(I_end:end),correction_factor((I_end:end)).*temp(I_end:end)/temp(I_end),'--r*')
% plot(ASWING1.Var2(I_end:end),temp(I_end:end)/temp(I_end),'--r*')
% plot(inch2meter*CFD7.Var3,CFD7.Var4,'-bs','linewidth',1)
hold on
% plot(inch2meter*CFD7.Var5,CFD7.Var6,'-rd','linewidth',1)
% hold on
% plot(inch2meter*CFD7.Var7,CFD7.Var8,'-*','Color',[0 0.5 0])
grid on 
xlabel('span distribution in m')
ylabel('normalized lift/length l(y)/l(0) N/m')
saveas(gcf,'CASE7','epsc')